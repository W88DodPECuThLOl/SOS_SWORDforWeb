# Change log

## [0.00.01] - 2023-01
- IO Z80 CTC $1FA0～$1FA3
  - CPUとCTCのクロックによる同期を修正
    - 「OUT (C),A直後にIN A,(C)」で正しくDownCounterが取得できるようになった
- IO AY-3-8910 $1Bxx～$1Cxx
  - ジョイスティック１（ゲームパッド）に対応
- IO 8255 $1Ax1
  - ポートB 7bit 垂直帰線期間信号 実装中……
- S-OS #DRDSBを呼び出すとフリーズしていたのを修正
- S-OS #ROPENで、IBを設定するように修正
  - IBを参照しているものの対応
- S-OS #GETPCが正常に動作していなかったのを修正
- S-OS #HLが正常に動作していなかったのを修正
- S-OS #HLHEXが正常に動作していなかったのを修正
- S-OS #SCRNで画面外が指定されていた場合、Bad Dataエラーを設定するように変更
- S-OS #SCRNで取得した文字コードが0x20未満の場合、0x20にするように変更
- S-OS #LOCで画面外が指定されていた場合、キャリフラグを立て、Bad Dataエラーを設定するように修正
- S-OS #VER 機種を28hに変更
- S-OS #MON実装
- S-OS #RDVSWが間違っていたのを修正
- S-OS #SDVSWが間違っていたのを修正
- S-OS #MCOM($211B) ※DOS部分のサブルーチン
  - DEレジスタにS-OS標準モニタのコマンド文字列(終端$00)のアドレスを入れ呼び出すと、コマンドを実行する
  - エラー時には、キャリをセットしAレジスタにエラーコードが格納される
- S-OS標準モニタ ファイルアクセス部分の修正
  - メディアタイプが2Dの場合、FATの後半128バイトは無視するように修正
    - Oh!石(@oec_Nibbleslab)様、いろまげんくてい(@stmlad)様、感謝。
  - ※**2Dのみ対応、他のメディアタイプは対応していません**
- S-OS標準モニタ 空白＋ファイル名で、かつ、ファイルがバイナリの場合、  
  DEレジスタに、ファイル名後の文字列のアドレスを設定するように修正  
  「#  HOGE:AAA」のような場合、"AAA"文字列の先頭アドレスがDEに設定され「HOGE」が実行される。
- S-OS"SWORD" for Web
  - ファイル選択で、S-OSヘッダ付きのバイナリファイルを**直接読み込み実行する**ように修正
    ヘッダは18バイトで、マジックナンバー、属性、読み込み先頭アドレス、実行アドレスが順に格納される。  
    末尾は0x0A。C言語風には"_SOS 01 3000 3000\x0A"みたいな文字列になる。  
    ``_``SOS : マジックナンバー。  "``_``"は0x5F  
    01 : 属性(ファイルモード)。16進2桁。01はバイナリファイル。04はアスキーファイル  
    3000 : 読み込み先頭アドレスを16進4桁で（バイナリファイルのみ有効）  
    3000 : 実行アドレスを16進4桁で（バイナリファイルのみ有効）

## [0.00.00] - 2022-12
- 最初のリリース
- 表示文字列をS-OS準拠に
- X1のVRAMフォーマットで、0x4000～0xFFFFの内容を出力するように
- S-OS標準モニタでJコマンドが動作しないことがあったのを修正
- S-OS標準モニタでカタカナなどの文字が含まれるファイルが読み込めなかった不具合を修正
- S-OS標準モニタPコマンド実装
- 画面サイス40x25と画面サイス80x25で、キャラクタのサイズを変更するように変更
- S-OS標準モニタの空白コマンド、バイナリファイルに対応
- S-OS標準モニタの空白コマンド、アスキーファイルのバッチ処理を実装  
  ~~テストはしていないので、動作するかどうかは不明~~  
  S-OS標準のモニタコマンドの実行ができるように。  
- S-OS標準モニタのファイルリスト表示部分の16進数を大文字に変更
- カーソルの表示、非表示を制御するように修正
- X1のグラフィックパレットに対応してみたつもり、未テスト
- S-OS #FILEが正常に動作していなかったのを修正
- S-OS #ROPENが正常に動作していなかったのを修正
